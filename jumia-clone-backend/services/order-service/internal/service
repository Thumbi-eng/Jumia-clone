package service

import (
    "context"
    "errors"
    "github.com/google/uuid"
)

type Order struct {
    ID     string
    UserID string
    Items  []OrderItem
}

type OrderItem struct {
    ProductID string
    Quantity  int
}

type OrderService struct {
    orders map[string]Order
}

func NewOrderService() *OrderService {
    return &OrderService{
        orders: make(map[string]Order),
    }
}

func (s *OrderService) CreateOrder(ctx context.Context, userID string, items []OrderItem) (string, error) {
    if userID == "" {
        return "", errors.New("user ID cannot be empty")
    }
    if len(items) == 0 {
        return "", errors.New("order must contain at least one item")
    }

    orderID := uuid.New().String()
    order := Order{
        ID:     orderID,
        UserID: userID,
        Items:  items,
    }
    s.orders[orderID] = order

    return orderID, nil
}

func (s *OrderService) GetOrder(ctx context.Context, orderID string) (Order, error) {
    order, exists := s.orders[orderID]
    if !exists {
        return Order{}, errors.New("order not found")
    }
    return order, nil
}